# Cloud Run 用の本番設定テンプレートです。以下の値はすべてダミーなので、
# `cp env.deploy.example .env.deploy` で複製したあと、実際の GCP プロジェクト情報やドメインに置き換えてください。
# `SESSION_SECRET_KEY` は `./scripts/deploy_cloud_run.sh --generate-secret` で安全な乱数へ自動補完できます。

# --- Cloud Run / Artifact Registry の基本情報 ---
ENVIRONMENT=production
PROJECT_ID=replace-with-your-prod-project
REGION=asia-northeast1
CLOUD_RUN_SERVICE=wordpack-backend
ARTIFACT_REPOSITORY=wordpack/backend

# --- Firestore（本番は Cloud Firestore、ローカル/CI はエミュレータで同一スキーマを使用） ---
# Firestore のプロジェクト ID。Cloud Run/プロジェクト ID と同じ値を指定することを推奨します。
FIRESTORE_PROJECT_ID=replace-with-your-prod-project
# 本番運用ではエミュレータを使わないため空のままにし、ローカルや CI で利用するときだけ設定してください。
# FIRESTORE_EMULATOR_HOST=127.0.0.1:8080
# FIRESTORE_EMULATOR_PORT=8080

# --- アプリケーションの認証/セキュリティ設定 ---
# Google OAuth クライアント ID。Cloud Console で発行した Web クライアントを設定してください。
GOOGLE_CLIENT_ID=1234567890-prod.apps.googleusercontent.com
# 任意: Google Workspace のドメイン制限を行う場合に設定します。不要なら空のままで問題ありません。
GOOGLE_ALLOWED_HD=example.com
# 必須: 本番で許可する管理者メールアドレス。未設定のままデプロイすると起動時に失敗します。
ADMIN_EMAIL_ALLOWLIST=admin@example.com,owner@example.com
# フロントエンドのアクセス元をカンマ区切りで列挙します。HTTPS 本番ドメインを指定してください。
CORS_ALLOWED_ORIGINS=https://app.example.com,https://admin.example.com
# Cloud Load Balancing/プロキシで信頼する CIDR をカンマ区切りで記載します。
TRUSTED_PROXY_IPS=35.191.0.0/16,130.211.0.0/22
# Cloud Run サービス URL や独自ドメインなど、API を公開するホスト名を列挙します。
# カンマ区切りで複数ホストを指定してもデプロイスクリプト側でそのまま 1 つの文字列として Cloud Run に渡されます。
ALLOWED_HOSTS=app-xxxx.a.run.app,api.example.com
# セッションクッキー署名用シークレット。`--generate-secret` や openssl で作成後に貼り付けてください。
SESSION_SECRET_KEY=replace-this-with-a-secure-random-string
# 必要に応じて Cookie 名を変更します（空または未設定時は `wp_session`）。Firebase Hosting との互換性のため、ここで指定した名前に加えて `__session` も同じトークンで配信されます。
# SESSION_COOKIE_NAME=wp_session
# ゲスト閲覧モード用 Cookie を明示したい場合は以下を設定します。
# GUEST_SESSION_COOKIE_NAME=wp_guest
# GUEST_SESSION_MAX_AGE_SECONDS=86400

# --- LLM 設定（ローカル .env と揃えておくと挙動が一致します） ---
# 必要に応じてモデル名やトークン上限を調整してください。
LLM_PROVIDER=openai
LLM_MODEL=gpt-4o-mini
LLM_TIMEOUT_MS=45000
LLM_MAX_RETRIES=1
LLM_MAX_TOKENS=1500

# Cloud Run のリクエストタイムアウト（任意）
# Firebase Hosting のリライトに起因する 60 秒制限は別問題のため、
# ここは Cloud Run 側の上限を伸ばしたい場合にのみ設定します。
# 例: 360s（6分） / 10m（10分）
CLOUD_RUN_TIMEOUT=360s

# Cloud Run の CPU スロットリング無効化（任意）
# true にすると、レスポンス送信後も CPU が割り当てられ続けます（運用コスト注意）。
CLOUD_RUN_NO_CPU_THROTTLING=false

# --- API キー / モデル設定 ---
# OpenAI など LLM の API キー。CI 用ダミー値はコミットせず、本番値をローカルで設定してください。
OPENAI_API_KEY=replace-with-real-openai-api-key

# Langfuse (optional)
# Enable and configure to send traces/metrics to Langfuse
LANGFUSE_ENABLED=true
LANGFUSE_PUBLIC_KEY=pk-xxxxxxxxxxxxxxxxxxxxxxx
LANGFUSE_SECRET_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxx
LANGFUSE_HOST=https://us.cloud.langfuse.com
LANGFUSE_RELEASE=wordpack-api@0.3.0

LANGFUSE_LOG_FULL_PROMPT=true
LANGFUSE_PROMPT_MAX_CHARS=40000
