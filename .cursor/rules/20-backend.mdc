---
description: "バックエンドのテスト指針（言語/フレームワーク非依存／Agent-Requested）"
alwaysApply: true
---
# バックエンド
- ドメイン/サービス層は外部I/Oを抽象化し**ビジネスルールを単体で厳密**に検証（例外/再試行/冪等性/境界値）。
- データ層の結合テスト：**実行可能なDB/シミュレータ**でCRUD・トランザクション・ユニーク制約を確認。
- マイグレーションは**空DB→最新**の適用と起動検証を含める。
- APIは**スキーマ/契約**を基準に検証（構造/型/必須性/エラーフォーマット/認証・認可/レート制御）。
- 外部連携（メール/キュー/他API）は**モック**＋リトライ/フォールバックの動作を検証。
- 軽量パフォーマンス回帰：主要エンドポイントの**しきい値（p95応答/エラーレート）**をCIで比較。
